openapi: 3.0.0
info:
  title: prontogram
  version: '1.0'
  description: È l'API offerta dall'APP di messaggistica *Prontogram* che vi racchiude la capability di inoltrare messaggi.
servers:
  - url: 'https://soseng-unibo.stoplight.io/mocks/soseng-unibo/soseng-project-documentation/6636887'
    description: testing
paths:
  /message:
    get:
      summary: Restituisci tutti i messaggi
      tags: []
      requestBody:
        content:
          application/vnd.api+json:
            schema:
              description: ''
              type: object
            examples:
              example-1: {}
          application/xml:
            schema:
              type: object
              properties: {}
        description: Dire che è al livello 3 di REST. Ricordarsi di aggiungere i codici di errore per quel livello.
      operationId: post-allmessage
      description: 'È la risorsa che, a fronte di una richiesta HTTP che specifica un `token` identificativo, restituisce tutti i messaggi (in blocchi di cardinalità n) cui ha accesso il fruitore (utente o ACMESky) identificato da quel token: in dettaglio, l''''utente ha accesso solo ai messaggi di cui è destinatario, mentre ACMESky ha accesso a tutti i messaggi che ha inoltrato ai suoi utenti mediante Prontogram e potrebbe richiederli per fini statistici, ad esempio.'
      security:
        - tokenSessione: []
      responses:
        '200':
          description: OK
          content:
            application/vnd.api+json:
              schema:
                description: ''
                type: object
                properties:
                  links:
                    type: object
                    properties:
                      self:
                        type: string
                        description: link al blocco corrente
                      next:
                        type: string
                        description: link al blocco successivo
                      prev:
                        type: string
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        message:
                          type: object
                          properties:
                            body:
                              type: string
                            receiver:
                              type: string
                            data:
                              type: string
                        links:
                          type: object
                          properties:
                            self:
                              type: string
                              description: Link al messaggio
                            next:
                              type: string
                              description: link a messaggio successivo in senso temporale
                            prev:
                              type: string
              examples:
                /message/mariorossi:
                  value:
                    links:
                      self: /message/mariorossi/from/0
                      next: /message/mariorossi/from/10
                      prev: /message/mariorossi/from/0
                    data:
                      - message:
                          body: 'nuova offerta, codice 1234'
                          receiver: mariorossi
                          date: '2020-03-02, 16:06 CET'
                        links:
                          self: /message/mariorossi/0
                          next: /message/mariorossi/1
                          prev: /message/mariorossi/0
                      - message:
                          body: 'nuova offerta, codice 1235'
                          receiver: mariorossi
                          date: '2020-03-05, 12:06 CET'
                        links:
                          self: /message/mariorossi/1
                          next: /message/mariorossi/2
                          prev: /message/mariorossi/0
                /message/mariorossi/4:
                  value:
                    links:
                      self: /message/mariorossi/4
                      next: /message/mariorossi/5
                      prev: /message/mariorossi/3
                    data:
                      - message:
                          body: 'nuova offerta, codice 1234'
                          receiver: mariorossi
                          date: '2020-03-02, 16:06 CET'
                        links:
                          self: /message/mariorossi/4
                          next: /message/mariorossi/5
                          prev: /message/mariorossi/3
        '400':
          description: Bad Request
        '406':
          description: Not Acceptable
        '415':
          description: Unsupported Media Type
    parameters: []
  /createmessage:
    post:
      summary: ''
      operationId: post-createmessage
      responses:
        '400':
          description: Bad Request
        '401':
          description: Unauthorized
          headers:
            Content-Type:
              schema:
                type: string
              description: application/vnd.api+json
        '406':
          description: Not Acceptable
        '415':
          description: Unsupported Media Type
      description: Crea (manda) un messaggio
      parameters: []
      security:
        - tokenSessione: []
      requestBody:
        content:
          application/vnd.api+json:
            schema:
              description: ''
              type: object
              properties:
                data:
                  type: object
                  properties:
                    receiver:
                      type: string
                      minLength: 1
                    body:
                      type: string
                      minLength: 1
                  required:
                    - receiver
                    - body
              required:
                - data
            examples:
              Esempio di messaggio:
                value:
                  data:
                    receiver: Mario rossi
                    body: 'Nuova offerta. Inserisci codice sul sito: 1234'
        description: Formato del messaggio
components:
  securitySchemes:
    tokenSessione:
      type: oauth2
      flows:
        authorizationCode:
          authorizationUrl: ''
          tokenUrl: ''
          refreshUrl: ''
          scopes: {}
      description: Abbiamo utilizzato OAuth2 come schema di sicurezza perché consente di creare un token di sessione che permette agli utenti di essere identificati da Prontogram e di fruire dei servizi che espone.
